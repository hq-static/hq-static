### 3-1-2 数据库设计

#### 数据域划分

 以模块划分为参考，数据域之间的关联尽量少

1. 系统数据
2. 用户行为数据（业务数据）

#### 系统数据设计

- 分析实体entity（包括属性）
  
  在用户需求中找出中心词（作为实体的备选）。
  
  找出跟中心词相关的属性。
  
  - 用户
    - 标识ID：主键（常见类型为数字，UUID，string）
    - 身份（去掉，身份就包含了用户名和密码，违反了1NF）
    - 用户名
    - 昵称
    - 密码
    - 角色（去掉，不符合1NF）
  - 角色
    - 标识ID：主键
    - 角色名
    - 备注
    - 排序
    - 上级角色（去掉，不符合1NF）
  - 资源
    - 标识ID：主键
    - 名称
    - URL
    - method
    - 类型
    - 排序
    - 上级资源（去掉，不符合1NF）
    - 备注
  
- 分析实体关系（通过主外键来实现）
  
  明确关系类型（1-1、1-n、n-n）
  
  1-1：外键可在任意一个实体中
  
  1-n：外键是放在n这个表，1（主表），n（从表）
  
  n-n：建一个关系表，关系表中就是两个实体的外键
  
  - 用户 - 角色：n - n
    - 新增用户-角色关系表
      - 用户ID
      - 角色ID
    - 从用户查询角色：select * from 角色表 join {用户角色关系表} on 角色表.ID = 用户角色关系表.角色ID where 用户角色关系表.用户ID = ""  
    - 从角色查询用户：select * from 用户表 join {用户角色关系表} on 用户表.ID = 用户角色关系表.用户ID where 用户角色关系表.角色ID = ""
  - 角色 - 资源：n - n
    - 新增角色-资源关系表
      - 角色ID
      - 资源ID
  - 角色 - 上级角色：n - 1
    - 在角色表上增加一个外键，parentID
  - 资源 - 上级资源 ：n - 1
    - 在资源表上增加一个外键，parentID

#### 用户行为数据设计

- 用户行为（基于原始数据）